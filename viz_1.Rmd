---
title: "viz_and_eda_day1"
output: html_document
date: "2025-09-25"
---

```{r}
library(tidyverse)
library(ggridges)
library(p8105.datasets)
```

Import the weather data

```{r}
data("weather_df")
```

Making our first plot :-)

Use the `+` operator to link together your code in ggplot (kind of like the pipe operator but for ggplot)

```{r}
ggplot(data = weather_df, mapping = aes(x = tmin, y = tmax)) + #telling R which data, and which variables
  geom_point()

```

Another way to do the same thing:

```{r}
weather_df |> 
  ggplot(aes(x = tmin, y = tmax)) +
  geom_point()
```

This is a way to save the plot to your environment (assign it to an object):

```{r}
ggp_weather_scatterplot =
  weather_df |> 
  ggplot(aes(x = tmin, y = tmax)) +
  geom_point()

ggp_weather_scatterplot #this is how I can see what I just saved
```

Check that some rows are missing.

```{r}

weather_df |> 
  filter(is.na(tmax)) #this will list out in the console all observations with missing tmax

```

## Fancier scatterplots!

alpha ranges from 0-1 (1=totally opaque, 0=totally see-through)
```{r}

weather_df |> 
  ggplot(aes(x = tmin, y = tmax, color = name)) + #different color for each name
  geom_point(alpha = 0.3) +#changes opacity of points so you can see where the highest density of data lies
  geom_smooth(se = FALSE) #puts a smooth line of best fit (for each color); se = FALSE removes SE bar

```


Where you define aesthetics can matter

```{r}
weather_df |> 
  ggplot(aes(x = tmin, y = tmax)) + 
  geom_point(aes(color = name), alpha = 0.3, size = 0.6) + 
  #makes my points a different size (<1 = smaller, >1 = bigger)
  geom_smooth(se = FALSE) 
#difference here is I get a best fit line for the whole plot, not for each name, because the color statement was not at the top, therefore it was not inherited by every layer below
```

```{r}
weather_df |> 
  ggplot(aes(x = tmin, y = tmax)) + 
  geom_point(aes(color = name, size = prcp), alpha = 0.3) + #bigger points w/ more rain, smaller w/ less rain
  geom_smooth(se = FALSE)
```

Use faceting real quick

```{r}

weather_df |> 
  ggplot(aes(x = tmin, y = tmax)) + 
  geom_point(aes(color = name), alpha = 0.3, size = 0.8) +
  geom_smooth(se = FALSE) + 
  facet_grid(. ~ name) #before squiggle `~` = row, after ~ = column --> separates into a grid of multiple plots

weather_df |> 
  ggplot(aes(x = tmin, y = tmax)) + 
  geom_point(aes(color = name), alpha = 0.3, size = 0.8) +
  geom_smooth(se = FALSE) + 
  facet_grid(name ~ .) #3 rows of plots instead of 3 columns of plots

```

Let's make a somewhat more interesting plot:

More info encoded in our graph here

```{r}

weather_df |> 
  ggplot(aes(x = tmin, y = tmax, color = name, shape = name)) + #points a different shape for each name
  geom_point(aes(size = prcp), alpha = 0.3) + 
  geom_smooth(se = FALSE) +
  facet_grid(. ~ name)

```

Learning assessment: write a codechain that starts with weather_df; focuses only on Central Park, converts temp to fahrenheight, makes a scatterplot of min vs. max temp, and overlays a linear regression line (using geom_smooth())

```{r}

weather_df |> 
  filter (name == "CentralPark_NY") |> 
  mutate (tmax_fh = tmax*(9/5) + 32, 
          tmin_fh = tmin*(9/5) + 32) |> 
  ggplot(aes(x = tmin_fh, y = tmax_fh)) +
  geom_point() +
  geom_smooth(se = FALSE, method = "lm") #default: '`geom_smooth()` using method = 'loess' and formula = 'y ~ x'.    We changed to `lm` for linear regression line

```

## Small things

```{r}

weather_df |> 
  ggplot(aes(x = tmin, y = tmax, color = name, shape = name)) + 
#  geom_point(alpha = 0.3) + (now I don't have points on my plot)
  geom_smooth(se = FALSE)

weather_df |> 
  ggplot(aes(x = tmin, y = tmax, color = name, shape = name)) + 
  geom_smooth(se = FALSE) +
  geom_point() #now points on top of smooth line (whatever you want on top put last)

```

Making a cool hexagon plot which shows density of points by color (communicates where most of data is)

```{r}
weather_df |> 
  ggplot(aes(x = tmin, y = tmax)) +
  geom_hex()
```

```{r}

weather_df |> 
  ggplot(aes(x = tmin, y = tmax)) +
  geom_point(color = "purple") #now everything is purple, not within an aes, I'm just telling R to make it ALL       purple (or I can pick any #hex code color like below)

weather_df |> 
  ggplot(aes(x = tmin, y = tmax)) +
  geom_point(color = "#F54927")

```

## Univariate plots

Creating a histogram of just one variable:

```{r}

weather_df |> 
  ggplot(aes(x = tmin)) +
  geom_histogram(color = "white", fill = "red")

```

```{r}

weather_df |> 
  ggplot(aes(x = tmin, color = name)) +
  geom_histogram()

weather_df |> 
  ggplot(aes(x = tmin, fill = name)) +
  geom_histogram()

#splitting into multiple histograms (better to compare in this case)
weather_df |> 
  ggplot(aes(x = tmin, fill = name)) +
  geom_histogram() +
  facet_grid (name ~ .)

```

maybe a density plot?

```{r}
weather_df |> 
  ggplot(aes(x = tmin, fill = name)) +
  geom_density(alpha = 0.2) 
```

Trying box plots

```{r}
weather_df |> 
  ggplot(aes(x = name, y = tmin)) +
  geom_boxplot(aes(fill = name))
```

violin plots

**Anything you put in the aes statement, you are mapping, for example a color to a specific name. If you make an aesthetic change but not in the aes statement, it changes for everything, it's not different by name

```{r}

weather_df |> 
   ggplot(aes(x = name, y = tmin, fill = name)) +
   geom_violin()

```

ridge plot

```{r}
weather_df |> 
  ggplot(aes(x = tmin, y = name)) +
   geom_density_ridges()
```

LA: univariate plots

make plots that compare precipitation across locations. Try a histogram, density plot, boxplot, violin plot, and a ridgeplot; use aesthetic mappings to make your figures readable.

```{r}

weather_df |> 
  ggplot(aes(x = prcp, fill = name)) +
  geom_density(alpha = 0.2)

weather_df |> 
  ggplot(aes(x = prcp, fill = name)) +
  geom_histogram() +
  facet_grid(name ~ .)

#filtering the data to just look at the middle range of data (just remember you did this)
weather_df |> 
  filter(prcp > 5, prcp < 1000) |> 
  ggplot(aes(x = prcp, fill = name)) +
  geom_density(alpha = 0.2)

```

## Saving and embedding plots

Saving plots (goes to environment, does not go to print unless you call its name)

```{r}
ggp_weather_violin =
  weather_df |> 
   ggplot(aes(x = name, y = tmin, fill = name)) +
   geom_violin()

ggp_weather_violin

ggsave("violin_plot.pdf", ggp_weather_violin,
       width = 8, height = 6) #you can save as .pdf, .png, .jpeg, whatever. I can also save to a folder e.g. named        plots by doing: ggsave("plots/violin_plot.pdf"

```

embedding plots 

(Here I changed the size for this particular figure in the embedded readme)

```{r, fig.width = 6, fig.height = 4}

ggp_weather_violin

```

